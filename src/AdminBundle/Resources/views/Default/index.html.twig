{% extends 'AdminBundle::layout.html.twig' %}
{% block content %}
    <h1>Панель управления</h1>
    {% for flashMessage in app.session.flashbag.get('notice') %}
        <div class="alert alert-success">
            {{ flashMessage }}
        </div>
    {% endfor %}
    {% for flashMessage in app.session.flashbag.get('alert') %}
        <div class="alert alert-danger">
            {{ flashMessage }}
        </div>
    {% endfor %}
	<div class="row index clearfix">
		<div class="col-md-3">
			<div>
				<h2><i class="fa fa-files-o"></i> {{ pages }}</h2>
				<a href="{{ path('admin_pages_index') }}"><b>Страниц контента</b></a><br><br>
			</div>
		</div>
		<div class="col-md-3">
			<div>
				<h2><i class="fa fa-building-o"></i> {{ objects }}</h2>
				<a href="{{ path('admin_objects_index') }}"><b>Объектов</b></a><br><br>
			</div>
		</div>
		<div class="col-md-3">
			<div>
				<h2><i class="fa fa-envelope-o"></i> {{ messages|length }}</h2>
				<b>Сообщений</b><br><br>
			</div>
		</div>
	</div>
	<div class="clearfix">
		<h2>Сообщения</h2>
		<table class="table table-hover">
			<thead>
				<tr><th>Имя</th><th>Телефон</th><th>Объект</th><th>Консультант</th><th>Дата</th><th></th></tr>
			</thead>
			<tbody>
				{% for message in messages %}
					<tr>
						<td><b>{{ message.name }}</b></td>
						<td><b>{{ message.phone }}</b></td>
						<td>{% if message.objectId %}<a href="{{ path('admin_objects_edit', {'id':message.Objects.id}) }}" target="_blank">{{ message.Objects.title }}</a>{% else %}-{% endif %}</td>
						<td>{% if message.userId %}{{ message.User.username }}{% else %}-{% endif %}</td>						
						<td>{{ message.createdAt|date('H:i d.m.Y') }}</td>
						<td class="text-right"><a href="{{ path('admin_default_delmess', {'id':message.id}) }}"><i class="fa fa-times fa-fw" title="удалить"></i></a></td>
					</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>

{% endblock %}
